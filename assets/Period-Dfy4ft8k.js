import{d as ue,e as j,_ as U,n as A,g as a,h as Ce,i as Oe,j as Ie,k as Ae,u as Fe,a as Pe,c as qe,b as Ee,f as Ne,o as Le,l as Re,m as Te}from"./GpnOverlay.vuelim_vuelim_typelim_stylelim_indexlim_0lim_lang-BTUzPWvv.js";import{d as Q,h as p,v as b,o as r,c,H as g,N as re,R as Y,b as S,e as m,J as x,a as f,l as K,D as Ue,T as Ge,I as Xe,q as je,U as He,F as V,i as z,X as Je,u as Ke,p as Qe,g as We}from"./index-BuqtH1Xl.js";import{_ as Ze}from"./lim_plugin-vuelim_export-helper-DlAUqK2U.js";const et={key:0},tt={class:"cv-textfield-body"},at=["value","maxlength","type","placeholder","disabled","required","readonly","rows"],lt=["value","maxlength","type","placeholder","disabled","required","readonly","pattern","tabindex"],ot={key:3,class:"cv-textfield-clear"},st={key:0,class:"cv-textfield-caption"},ne=Q({__name:"GpnTextField",props:{label:{type:String,default:""},caption:{type:String,default:""},view:{type:String,default:"default"},disabled:{type:Boolean,default:!1},size:{type:String,default:"m"},type:{type:String,default:"text"},modelValue:{type:[String,Number],default:""},width:{type:String,default:"default"},form:{type:String,default:"default"},status:{type:String,default:""},required:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},withClearButton:{type:Boolean,default:!1},labelPosition:{type:String,default:"top"},maxLength:{type:Number,default:0},placeholder:{type:String,default:""},theme:{type:String,default:"kp"},rows:{type:Number,default:3},iconLeft:{type:String,default:""},iconRight:{type:String,default:""},pattern:{type:String,default:""},ripple:{type:Boolean,default:!0},tabindex:{type:Number,default:0}},emits:["input","update:modelValue","focus","focusout","blur"],setup(v,{expose:F,emit:e}){const l=v,k=p(!1),D=p(),_=p();l.ripple&&!l.readonly&&ue(D);const C=b(()=>{const o=new A("textfield");return[o.namespace(),o.block(l.view),o.block(l.size,"size"),o.block(l.labelPosition,"label-position"),o.block(l.view,"view"),o.block(l.width,"width"),l.disabled&&o.modifier("disabled"),l.readonly&&o.modifier("readonly"),o.block(l.status||"undefined","status"),`cv-theme-${l.theme}`]}),H=b(()=>{const o=new A("textfield-label");return[o.namespace(),o.block(l.size,"size")]}),E=b(()=>{const o=new A("textfield-input-container");return[o.namespace(),l.withClearButton&&l.modelValue&&o.modifier("clear-btn"),l.type==="textarea"&&o.modifier("textarea"),k.value&&o.modifier("focus"),l.disabled&&o.modifier("disabled"),o.modifier("form_"+l.form),o.block(l.status||"undefined","status")]});function N(){_.value&&_.value.focus()}function O(){_.value&&_.value.blur()}function M(o){k.value=!0,$("focus",o)}function s(o){k.value=!1,$("blur",o)}function n(o){$("input",o),$("update:modelValue",o.target.value)}const $=e;function G(){$("update:modelValue","")}return F({focusInput:N,blurInput:O,input:_}),(o,w)=>(r(),c("div",{class:g(C.value)},[v.label?(r(),c("div",{key:0,class:g(H.value)},[re(Y(v.label),1),l.required?(r(),c("span",et,[S(m(j),{name:"bi-asterisk",view:"alert",size:"10",theme:l.theme},null,8,["theme"])])):x("",!0)],2)):x("",!0),f("div",tt,[f("div",{ref_key:"tfContainer",ref:D,class:g(E.value)},[l.iconLeft?(r(),K(m(j),{key:0,class:"cv-textfield-body--left-icon",name:l.iconLeft,size:l.size,view:"ghost",theme:l.theme},null,8,["name","size","theme"])):x("",!0),l.type==="textarea"?(r(),c("textarea",{key:1,ref_key:"input",ref:_,value:v.modelValue,class:"cv-textfield-input",maxlength:l.maxLength>0?l.maxLength:void 0,type:l.type,placeholder:l.placeholder,disabled:l.disabled,required:l.required,readonly:l.readonly,rows:l.rows,onFocus:M,onBlur:s,onInput:n},null,40,at)):(r(),c("input",{key:2,ref_key:"input",ref:_,value:v.modelValue,class:"cv-textfield-input",maxlength:l.maxLength>0?l.maxLength:void 0,type:l.type,placeholder:l.placeholder,disabled:l.disabled,required:l.required,readonly:l.readonly,pattern:l.pattern,tabindex:l.disabled?-1:l.tabindex,onFocus:M,onBlur:s,onInput:n,onFocusout:w[0]||(w[0]=I=>$("focusout",I))},null,40,lt)),l.withClearButton&&v.modelValue?(r(),c("div",ot,[S(m(U),{view:"clear-ghost",clear:"",size:l.size,"only-icon":"","icon-left":"bi-x-lg",theme:l.theme,onClick:G},null,8,["size","theme"])])):x("",!0),l.iconRight?(r(),K(m(j),{key:4,class:g(`cv-textfield-body--right-icon${l.withClearButton&&v.modelValue?"__with-clear":""}`),name:l.iconRight,size:l.size,view:"ghost",theme:l.theme},null,8,["class","name","size","theme"])):x("",!0)],2),v.caption?(r(),c("div",st,Y(v.caption),1)):x("",!0)])],2))}}),nt={key:0},it=f("div",{class:"period-delim"},null,-1),ut={key:1,class:"cv-date-caption"},rt={class:"cv-period-calendar"},dt={class:"cv-period-calendar--years"},ct={class:"years-slider"},ft={class:"years-slider--wrapper"},vt=["onClick"],mt={class:"cv-period-calendar--months"},ht={class:"cv-period-calendar--month"},pt={class:"cv-period-calendar--month-title"},yt={class:"cv-period-calendar--weekdays"},bt=["onClick"],gt={class:"cv-period-calendar--month"},kt={class:"cv-period-calendar--month-title"},_t={class:"cv-period-calendar--weekdays"},wt=["onClick"],ie=Q({__name:"GpnPeriod",props:{label:{type:String,default:""},caption:{type:String,default:""},disabled:{type:Boolean,default:!1},size:{type:String,default:"m"},form:{type:String,default:"default"},status:{type:String,default:""},required:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},labelPosition:{type:String,default:"top"},placeholder:{type:String,default:"ДД.ММ.ГГГГ"},format:{type:String,default:"DD.MM.YYYY"},theme:{type:String,default:"kp"},modelValue:{type:Array,required:!0},notAfter:{type:String,default:""},notBefore:{type:String,default:""},bold:{type:Boolean,default:!1},options:{type:Array,default:()=>[]}},emits:["change","update:modelValue","input"],setup(v,{emit:F}){a.locale("ru"),a.extend(Ce),a.extend(Oe),a.extend(Ie),a.extend(Ae);const e=v,l=p(!1),k=p(""),D=p(!1),_=p(!1),C=p(!1),H=p(),E=p(),N=p(),O=p(),M=p(),s=p(e.modelValue&&e.modelValue.length==2&&e.modelValue[0]&&a(e.modelValue[0],e.format,!0).isValid()?a(e.modelValue[0],e.format):null),n=p(e.modelValue&&e.modelValue.length==2&&e.modelValue[1]&&a(e.modelValue[1],e.format,!0).isValid()?a(e.modelValue[1],e.format):null),$=a(),G=p(["пн","вт","ср","чт","пт","сб","вс"]),o=p(s.value?s.value.date(1).toDate():a().date(1).toDate()),w=p([]),I=p(!1),L=p(!1),de=()=>{if(I.value){I.value=!1;const t=a(o.value).year()+1;w.value.shift(),o.value=a(o.value).year(t).toDate(),w.value.push(P(a(o.value).year()+2))}if(L.value){L.value=!1;const t=a(o.value).year()-1;w.value.pop(),o.value=a(o.value).year(t).toDate(),w.value.unshift(P(a(o.value).year()-1))}},ce=(t,u)=>{o.value=a(o.value).month(t-1).toDate(),t===1&&a(o.value).year()!==u&&(o.value=a(o.value).month(t-1).toDate(),W())};function W(){I.value=!0}function fe(){L.value=!0}function Z(t){t.otherMonth||t.outOfRange||(!s.value&&!n.value?k.value==="start"?(s.value=t.date,M.value.focusInput()):k.value==="finish"?(n.value=t.date,O.value.focusInput()):(s.value=t.date,M.value.focusInput()):!s.value&&n.value?k.value==="finish"?(n.value=t.date,O.value.focusInput()):t.date.isSameOrBefore(n.value,"d")?s.value=t.date:(s.value=n.value,n.value=t.date):s.value&&!n.value?k.value==="start"?(s.value=t.date,M.value.focusInput()):t.date.isSameOrAfter(s.value,"d")?n.value=t.date:(n.value=s.value,s.value=t.date):s.value&&n.value&&(k.value==="start"?t.date.isSameOrAfter(n.value,"d")?(s.value=n.value,n.value=t.date):(s.value=t.date,M.value.focusInput()):k.value==="finish"?t.date.isSameOrBefore(s.value,"d")?(n.value=s.value,s.value=t.date):(n.value=t.date,O.value.focusInput()):t.date.isSameOrBefore(s.value,"d")?s.value=t.date:n.value=t.date),q())}function P(t){const u=[];for(let i=1;i<=12;i++)u.push({month:i,title:a(`01.${i}.${t}`,"DD.M.YYYY").format("MMM"),active:i===a(o.value).month()});return{year:t,monthes:u}}const ve=b(()=>a(o.value).format("MMMM YYYY")),ee=b(()=>ae(o.value)),me=b(()=>Math.ceil(ee.value.length/7)),te=b(()=>ae(a(o.value).add(1,"month").date(1).toDate())),he=b(()=>Math.ceil(te.value.length/7)),pe=b(()=>a(o.value).add(1,"month").date(1).format("MMMM YYYY"));function ae(t){const u=a(t);let i=a(u).date(1).set("hour",0).set("minute",0).set("second",0).set("millisecond",0),h=a(u).endOf("month").set("hour",0).set("minute",0).set("second",0).set("millisecond",0);i.day()!=1&&(i=i.subtract(i.day()===0?6:i.day()-1,"days")),h.day()!=0&&(h=h.add(7-h.day(),"days"));const y=[],d=a.duration(h.diff(i)).asDays()+1;for(let T=0;T<d;T++)y.push({date:a(i),text:i.date(),otherMonth:i.month()!==u.month(),outOfRange:!R(i)}),i=i.add(1,"days");return y}Ue(()=>{w.value.push(P(a(o.value).year()-1)),w.value.push(P(a(o.value).year())),w.value.push(P(a(o.value).year()+1)),w.value.push(P(a(o.value).year()+2))});function R(t){let u=!1;return e.notBefore&&e.notAfter?u=a(t).isSameOrBefore(a(e.notBefore,e.format))||a(t).isSameOrAfter(a(e.notAfter,e.format)):e.notBefore?u=a(t).isSameOrBefore(a(e.notBefore,e.format)):e.notAfter?u=a(t).isSameOrAfter(a(e.notAfter,e.format)):u=!1,!u}ue(E),Fe(N,xe);const ye={name:"mOverflow",async fn(t){const u=await Te(t,{boundary:document.querySelector("body")});return{data:{shouldTeleport:u.left>=0||u.right>=0}}}},{floatingStyles:be,placement:X,middlewareData:ge}=Pe(E,N,{placement:"bottom-start",whileElementsMounted:Ee,middleware:[Ne({crossAxis:!1}),Le(4),ye,Re()],open:C}),ke=b(()=>{const t=new A("period");return[t.namespace(),t.block(e.size,"size"),t.block(e.labelPosition,"label-position"),e.disabled&&t.modifier("disabled"),e.readonly&&t.modifier("readonly"),e.bold&&t.modifier("bold"),t.block(e.status||"undefined","status"),`cv-theme-${e.theme}`]}),_e=b(()=>{const t=new A("period-label");return[t.namespace(),t.block(e.size,"size")]}),we=b(()=>{const t=new A("period-input-container");return[t.namespace(),l.value&&t.modifier("focus"),e.disabled&&t.modifier("disabled"),t.modifier("form_"+e.form),t.block(e.status||"undefined","status"),X.value.indexOf("top")>=0&&t.modifier("top"),X.value.indexOf("bottom")>=0&&t.modifier("bottom")]}),Ye=b(()=>{const t=new A("period-picker");return[t.namespace(),`cv-theme-${e.theme}`,t.block(e.size,"size"),X.value.indexOf("top")>=0&&t.modifier("top"),X.value.indexOf("bottom")>=0&&t.modifier("bottom")]});Ge(()=>e.modelValue,()=>{s.value=e.modelValue&&e.modelValue.length==2&&e.modelValue[0]&&a(e.modelValue[0],e.format,!0).isValid()&&R(a(e.modelValue[0],e.format))?a(e.modelValue[0],e.format):null,n.value=e.modelValue&&e.modelValue.length==2&&e.modelValue[1]&&a(e.modelValue[1],e.format,!0).isValid()&&R(a(e.modelValue[1],e.format))?a(e.modelValue[1],e.format):null});const Se=b(()=>s.value&&s.value.isValid()?s.value.format(e.format):""),Ve=b(()=>n.value&&n.value.isValid()?n.value.format(e.format):"");function xe(){l.value=!1,C.value=!1}const le=()=>{C.value=!C.value},De=()=>{l.value=!0},Me=()=>{},oe=t=>{t&&(k.value="start"),D.value=t},se=t=>{t&&(k.value="finish"),_.value=t},$e=t=>{const u=O.value.input;if(!u)return;const i=u.value;a(i,e.format,!0).isValid()&&R(a(i,"DD.MM.YYYY"))?(s.value=a(i,"DD.MM.YYYY"),q()):i===""&&(s.value=null,q()),J("input",t)},ze=t=>{const u=M.value.input;if(!u)return;const i=u.value;(a(i,e.format,!0).isValid()||a(i,"DD.MM.YYYY",!0).isValid()||a(i,"D.M.YYYY",!0).isValid()||a(i,"DD.M.YYYY",!0).isValid()||a(i,"D.MM.YYYY",!0).isValid()||a(i,"DDMMYYYY",!0).isValid())&&R(a(i,"DD.MM.YYYY"))?(n.value=a(i,"DD.MM.YYYY"),q()):i===""&&(n.value=null,q()),J("input",t)},Be=t=>{try{const u=t.from&&a(t.from,e.format).isValid()?a(t.from,e.format):a(),i=a(u).add(t.shift,t.type||"d");s.value=u.isBefore(i)?u:i,n.value=i.isAfter(u)?i:u,q()}catch{throw"Unresolved error while converting periods"}},J=F;function q(){J("update:modelValue",[s.value?s.value.format("DD.MM.YYYY"):"",n.value?n.value.format("DD.MM.YYYY"):""])}return(t,u)=>{var i;return r(),c("div",{ref_key:"periodElem",ref:H,class:g(ke.value),tabindex:"0",onFocus:De,onBlur:Me},[v.label?(r(),c("div",{key:0,class:g(_e.value)},[re(Y(v.label),1),e.required?(r(),c("span",nt,[S(m(j),{name:"bi-asterisk",view:"alert",size:"10",theme:e.theme},null,8,["theme"])])):x("",!0)],2)):x("",!0),f("div",{ref_key:"dateContainerElem",ref:E,class:g(we.value)},[S(m(ne),{ref_key:"sDateInput",ref:O,"model-value":Se.value,tabindex:-1,size:e.size,theme:e.theme,width:"full",view:"clear",placeholder:v.placeholder,ripple:!1,onInput:$e,onFocus:u[0]||(u[0]=h=>oe(!0)),onBlur:u[1]||(u[1]=h=>oe(!1))},null,8,["model-value","size","theme","placeholder"]),S(m(U),{tag:"div",view:"clear-ghost",ripple:!1,theme:e.theme,size:e.size,"only-icon":"","icon-left":"bi-calendar-range",onClick:le},null,8,["theme","size"]),it,S(m(ne),{ref_key:"fDateInput",ref:M,"model-value":Ve.value,tabindex:-1,size:e.size,theme:e.theme,width:"full",view:"clear",placeholder:v.placeholder,ripple:!1,onInput:ze,onFocus:u[2]||(u[2]=h=>se(!0)),onBlur:u[3]||(u[3]=h=>se(!1))},null,8,["model-value","size","theme","placeholder"]),S(m(U),{tag:"div",view:"clear-ghost",ripple:!1,theme:e.theme,size:e.size,"only-icon":"","icon-left":"bi-calendar-range",onClick:le},null,8,["theme","size"])],2),v.caption?(r(),c("div",ut,Y(v.caption),1)):x("",!0),(r(),K(Je,{to:"body",disabled:!((i=m(ge).mOverflow)!=null&&i.shouldTeleport)},[C.value?(r(),c("div",{key:0,ref_key:"pickerElem",ref:N,class:g(Ye.value),style:Xe(m(be))},[je(S(m(qe),{items:v.options,class:"cv-period--preselector",theme:e.theme,"scroll-options":{wheelPropagation:!1},onClick:Be},null,8,["items","theme"]),[[He,e.options.length>0]]),f("div",rt,[f("div",dt,[S(m(U),{view:"ghost",size:"xl",theme:e.theme,"only-icon":"","icon-left":"bi-arrow-left-short",onClick:fe},null,8,["theme"]),f("div",ct,[f("div",ft,[f("div",{class:g(["years-slider--sel-month",`shift-${m(a)(o.value).month()+1}`])},null,2),(r(!0),c(V,null,z(w.value,(h,y)=>(r(),c("div",{key:y,class:g(["years-slider--year",[`pos-${y}`,{"go-next":I.value},{"go-prev":L.value}]]),onAnimationend:de},Y(h.year),35))),128)),(r(!0),c(V,null,z(w.value,(h,y)=>(r(),c("div",{key:y,class:g(["years-slider--months",[`pos-${y}`,{"go-next":I.value},{"go-prev":L.value}]])},[(r(!0),c(V,null,z(h.monthes,d=>(r(),c("div",{key:d.month,class:g(["years-slider--month",{bold:d.month===m(a)(o.value).month()+1||d.month===m(a)(o.value).month()+2}]),onClick:T=>ce(d.month,h.year)},Y(d.title),11,vt))),128))],2))),128))])]),S(m(U),{view:"ghost",size:"xl",theme:e.theme,"only-icon":"","icon-left":"bi-arrow-right-short",onClick:W},null,8,["theme"])]),f("div",mt,[f("div",ht,[f("div",pt,Y(ve.value),1),f("div",yt,[(r(!0),c(V,null,z(G.value,h=>(r(),c("div",{key:h,class:"cv-period-calendar--weekday"},Y(h),1))),128))]),(r(!0),c(V,null,z(me.value,(h,y)=>(r(),c("div",{key:y,class:"cv-period-calendar--week"},[(r(!0),c(V,null,z(ee.value.slice(y*7,y*7+7),d=>(r(),c("div",{key:`${y}-${d.text}`,class:g(["cv-period-calendar--day",{"other-month":d.otherMonth,"out-of-range":d.outOfRange,today:d.date.isSame(m($),"day"),active:d.date.isSame(s.value,"day")||d.date.isSame(n.value,"day"),"has-finish":n.value&&d.date.isSame(s.value,"day")&&n.value!==s.value,"has-start":s.value&&d.date.isSame(n.value,"day")&&n.value!==s.value,"in-period":s.value&&n.value&&d.date.isBefore(n.value,"day")&&d.date.isAfter(s.value,"day")}]),onClick:T=>Z(d)},[f("div",null,Y(d.text),1)],10,bt))),128))]))),128))]),f("div",gt,[f("div",kt,Y(pe.value),1),f("div",_t,[(r(!0),c(V,null,z(G.value,h=>(r(),c("div",{key:h,class:"cv-period-calendar--weekday"},Y(h),1))),128))]),(r(!0),c(V,null,z(he.value,(h,y)=>(r(),c("div",{key:y,class:"cv-period-calendar--week"},[(r(!0),c(V,null,z(te.value.slice(y*7,y*7+7),d=>(r(),c("div",{key:`${y}-${d.text}`,class:g(["cv-period-calendar--day",{"other-month":d.otherMonth,"out-of-range":d.outOfRange,today:d.date.isSame(m($),"day"),active:d.date.isSame(s.value,"day")||d.date.isSame(n.value,"day"),"has-finish":n.value&&d.date.isSame(s.value,"day")&&n.value!==s.value,"has-start":s.value&&d.date.isSame(n.value,"day")&&n.value!==s.value,"in-period":s.value&&n.value&&d.date.isBefore(n.value,"day")&&d.date.isAfter(s.value,"day")}]),onClick:T=>Z(d)},[f("div",null,Y(d.text),1)],10,wt))),128))]))),128))])])])],6)):x("",!0)],8,["disabled"]))],34)}}}),B=v=>(Qe("data-v-7b0a4315"),v=v(),We(),v),Yt=B(()=>f("h2",null,"Period",-1)),St={class:"grid"},Vt=B(()=>f("h5",null,"Not-disabled",-1)),xt=B(()=>f("div",null,"XL",-1)),Dt=B(()=>f("div",null,"L",-1)),Mt=B(()=>f("div",null,"M",-1)),$t=B(()=>f("div",null,"S",-1)),zt=B(()=>f("div",null,"XS",-1)),Bt=B(()=>f("h5",null,"Default",-1)),Ct=B(()=>f("h5",null,"Active",-1)),Ot=Q({__name:"Period",setup(v){const F=Ke(),e=p([]),l=p([{id:"month",name:"За месяц",shift:-1,type:"month"},{id:"ten",name:"За 10 дней",shift:-10},{id:"week",name:"За неделю",shift:-7},{id:"month1",name:"За месяц",shift:-1,type:"month"},{id:"ten1",name:"За 10 дней",shift:-10},{id:"week1",name:"За неделю",shift:-7},{id:"month2",name:"За месяц",shift:-1,type:"month"},{id:"ten2",name:"За 10 дней",shift:-10},{id:"week2",name:"За неделю",shift:-7},{id:"month3",name:"За месяц",shift:-1,type:"month"},{id:"ten3",name:"За 10 дней",shift:-10},{id:"week3",name:"За неделю",shift:-7}]);return(k,D)=>(r(),c(V,null,[Yt,f("div",null,[f("div",St,[Vt,xt,Dt,Mt,$t,zt,Bt,S(m(ie),{modelValue:e.value,"onUpdate:modelValue":D[0]||(D[0]=_=>e.value=_),label:"Выбор даты",caption:"подтекст",theme:m(F).theme},null,8,["modelValue","theme"]),S(m(ie),{modelValue:e.value,"onUpdate:modelValue":D[1]||(D[1]=_=>e.value=_),options:l.value,label:"Выбор даты",caption:"подтекст",theme:m(F).theme},null,8,["modelValue","options","theme"]),Ct])])],64))}}),Pt=Ze(Ot,[["__scopeId","data-v-7b0a4315"]]);export{Pt as default};
//# sourceMappingURL=Period-Dfy4ft8k.js.map
